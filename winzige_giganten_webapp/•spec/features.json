{
  "repo": "2025_kunst_und_brot_winzige_giganten",
  "generated_at": "2025-09-26T00:00:00Z",
  "note": "Machine-friendly feature list for the winzige_giganten webapp. Validate selectors against the current HTML before implementing automated tests.",
  "global_notes": {
    "no_flashing_between_switches": true,
    "preload_both_videos": true,
    "recommended_timeout_seconds": 15,
    "manifest_files": ["winzige_giganten_webapp/video-manifest.json"]
  },
  "features": [
    {
      "status": "done",
      "id": "F001",
      "title": "Initial loading overlay",
      "description": "Display a full-screen loading animation overlay on first load while both video assets (teaser.mp4 and main.mp4) preload. The overlay must only be dismissed after both videos are in a playable state or after an operator-configurable timeout.",
      "priority": "high",
      "files_touched": [
        "winzige_giganten_webapp/winzige_giganten_index.html",
        "winzige_giganten_webapp/videos/teaser.mp4",
        "winzige_giganten_webapp/videos/main.mp4"
      ],
      "acceptance_criteria": [
        "Overlay visible immediately on cold load and blocks interactions.",
        "Both videos are loaded in the background and the overlay hides only after both fire a playable event (e.g. 'canplaythrough' or 'loadeddata').",
        "If the preload step times out (configurable, default 15s), the overlay shows an error state with retry or diagnostics.",
        "Dismissing the overlay without both videos ready must not cause a visible flash between video switches later."
      ],
      "tests": {
        "manual": [
          "Cold-load the page over HTTP and confirm the overlay remains until both videos are playable.",
          "Simulate a missing asset and confirm error state appears after timeout and retry works."
        ],
        "automated": [
          "Puppeteer/Playwright: intercept and stub video requests; wait for both playable events then assert overlay removed.",
          "Automation: stub a failure and assert overlay shows error after configured timeout."
        ]
      },
      "edge_cases": [
        "Browser autoplay restrictions: ensure videos are muted and use playsinline to improve preload reliability.",
        "Very slow networks: timeout should be operator-configurable (default 15s)."
      ]
    },
    {
      "status": "done",
      "id": "F002",
      "title": "Teaser: loop and fallback",
      "description": "When visible, the teaser video loops continuously. If the main video ends or is hidden, the teaser becomes visible and restarts from time 0 without audible pops or visual flashes.",
      "priority": "high",
      "files_touched": [
        "winzige_giganten_webapp/winzige_giganten_index.html",
        "winzige_giganten_webapp/videos/teaser.mp4"
      ],
      "acceptance_criteria": [
        "Teaser loops while active.",
        "After main ends, teaser is shown and plays from time 0 with a smooth cross-fade or opacity transition (no visible flashing)."
      ],
      "tests": {
        "manual": [
          "Trigger main and wait for it to end; verify teaser restarts at 0 and there is no flash."
        ],
        "automated": [
          "Simulate 'ended' on main and assert teaser visibility and currentTime === 0; optionally capture frames to detect abrupt flashes."
        ]
      },
      "edge_cases": [
        "If teaser file missing, validator should surface operator-facing diagnostics."
      ]
    },
    {
      "status": "done",
      "id": "F003",
      "title": "Input mapping: Space / HID button",
      "description": "Spacebar (keyboard) or the Arduino HID button must toggle teaser->main; when main is visible, pressing Space restarts the main video from time 0.",
      "priority": "high",
      "files_touched": [
        "winzige_giganten_webapp/winzige_giganten_index.html",
        "2025_kunst_und_brot_winzige_giganten.ino"
      ],
      "acceptance_criteria": [
        "When teaser visible, Space switches to main and begins playback.",
        "When main visible, Space resets main.currentTime to 0 and plays.",
        "Arduino sketch continues to emit a single Space keypress per button press with debounce and cooldown."
      ],
      "tests": {
        "manual": [
          "Press physical HID button and confirm main starts when teaser was visible; press again while main plays to restart it."
        ],
        "automated": [
          "Unit test the keydown handler in the page JS (jest/karma) by dispatching KeyboardEvent('keydown',{code:'Space'})."
        ]
      },
      "edge_cases": [
        "Multiple rapid button presses should be rate-limited by the Arduino cooldown to avoid repeated restarts."
      ]
    },
    {
      "status": "done",
      "id": "F004",
      "title": "Arduino HID button integration",
      "description": "Arduino sketch sends a USB HID Space keypress; sketch includes debounce and cooldown logic.",
      "priority": "high",
      "files_touched": ["2025_kunst_und_brot_winzige_giganten.ino"],
      "acceptance_criteria": [
        "Single press produces one Space event.",
        "Debounce and cooldown prevent rapid retriggers."
      ],
      "tests": {"manual": ["Upload to HID-capable board, press button, verify webapp reacts as Space."]},
      "edge_cases": ["Internal pullup wiring requires logic inversion if switching to INPUT_PULLUP."]
    },
    {
      "status": "done",
      "id": "F005",
      "title": "Video manifest & validator",
      "description": "Optional video-manifest.json to configure paths and a validator script for dev/CI that ensures assets exist.",
      "priority": "medium",
      "files_touched": ["winzige_giganten_webapp/video-manifest.json (suggested)", "scripts/validate-videos.js (suggested)"],
      "acceptance_criteria": [
        "App reads manifest when present; falls back to defaults.",
        "Validator exits non-zero if required assets missing."
      ],
      "tests": {"automated": ["Node script to assert files or manifest presence."]}
    },
    {
      "status": "done",
      "id": "F006",
      "title": "Dev preview server",
      "description": "Document minimal HTTP server command for local preview (required by some browsers for video).",
      "priority": "high",
      "files_touched": ["README.md"],
      "acceptance_criteria": ["README documents `python3 -m http.server 8000` and preview URL."],
      "tests": {"manual": ["Run server and open the preview URL."]}
    },
    {
      "status": "done",
      "id": "F007",
      "title": "Kiosk / iOS metadata",
      "description": "Meta tags for iOS home-screen fullscreen and landscape orientation.",
      "priority": "medium",
      "files_touched": ["winzige_giganten_webapp/winzige_giganten_index.html"],
      "acceptance_criteria": ["iOS web-app meta tags present and layout fits landscape/fullscreen."],
      "tests": {"manual": ["Install to iOS home screen and verify fullscreen behavior."]}
    },
    {
      "status": "done",
      "id": "F008",
      "title": "Non-ASCII path handling",
      "description": "The •spec folder contains a non-ASCII character; scripts must quote paths or avoid shell use.",
      "priority": "low",
      "files_touched": ["winzige_giganten_webapp/•spec/*"],
      "acceptance_criteria": ["Docs warn about `•spec` and show safe commands; scripts avoid unquoted paths."],
      "tests": {"manual": ["Open files with editor and run scripts with quoted paths."]}
    },
    {
      "status": "done",
      "id": "F009",
      "title": "Logging & debug",
      "description": "Minimal console logging for key events and video transitions, toggleable by debug flag.",
      "priority": "medium",
      "files_touched": ["winzige_giganten_webapp/winzige_giganten_index.html"],
      "acceptance_criteria": ["Debug logs appear when enabled; can be disabled for kiosk."],
      "tests": {"manual": ["Enable debug and exercise Start/Space to see logs."]}
    },
    {
      "status": "done",
      "id": "F010",
      "title": "E2E (software & hardware)",
      "description": "Automated browser E2E for software flows and a hardware checklist for Arduino integration.",
      "priority": "high",
      "files_touched": [],
      "acceptance_criteria": [
        "Automated tests simulate key events and assert DOM/video state transitions.",
        "Hardware checklist documents upload and verification steps."
      ],
      "tests": {"automated": ["Puppeteer/Playwright tests in tests/e2e"], "manual": ["Hardware verification checklist."]}
    },
    {
      "id": "F011",
      "title": "Editing safety",
      "description": "Document files and behaviors that must not be changed lightly (asset filenames, HID behavior).",
      "priority": "medium",
      "files_touched": [".github/copilot-instructions.md", "README.md"],
      "acceptance_criteria": ["Docs warn against renaming `videos/teaser.mp4` or `videos/main.mp4` and changing .ino HID behavior."],
      "tests": {"manual": ["Verify docs contain the safety notes."]}
    }
  ]
}
